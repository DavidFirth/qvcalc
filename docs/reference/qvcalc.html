<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Computes a set of quasi variances (and corresponding
  quasi standard errors) for estimated model coefficients
  relating to the levels of a categorical (i.e., factor)
  explanatory variable.  For details of the method see
  Firth (2000), Firth (2003) or Firth and de Menezes (2004).
  Quasi variances generalize and improve the accuracy of
  &amp;#8220;floating absolute risk&amp;#8221; (Easton et al., 1991).
  This device for economical model summary was
  first suggested by Ridout (1989)."><title>Quasi Variances for Model Coefficients — qvcalc • qvcalc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quasi Variances for Model Coefficients — qvcalc"><meta property="og:description" content="Computes a set of quasi variances (and corresponding
  quasi standard errors) for estimated model coefficients
  relating to the levels of a categorical (i.e., factor)
  explanatory variable.  For details of the method see
  Firth (2000), Firth (2003) or Firth and de Menezes (2004).
  Quasi variances generalize and improve the accuracy of
  &amp;#8220;floating absolute risk&amp;#8221; (Easton et al., 1991).
  This device for economical model summary was
  first suggested by Ridout (1989)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">qvcalc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Quasi Variances for Model Coefficients</h1>
      
      <div class="d-none name"><code>qvcalc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes a set of quasi variances (and corresponding
  quasi standard errors) for estimated model coefficients
  relating to the levels of a categorical (i.e., factor)
  explanatory variable.  For details of the method see
  Firth (2000), Firth (2003) or Firth and de Menezes (2004).
  Quasi variances generalize and improve the accuracy of
  “floating absolute risk” (Easton et al., 1991).
  This device for economical model summary was
  first suggested by Ridout (1989).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">qvcalc</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">qvcalc</span><span class="op">(</span><span class="va">object</span>, factorname <span class="op">=</span> <span class="cn">NULL</span>,  coef.indices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>      labels <span class="op">=</span> <span class="cn">NULL</span>, dispersion <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>      estimates <span class="op">=</span> <span class="cn">NULL</span>, modelcall <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for lm</span></span>
<span><span class="fu">qvcalc</span><span class="op">(</span><span class="va">object</span>, factorname <span class="op">=</span> <span class="cn">NULL</span>, coef.indices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       dispersion <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for coxph</span></span>
<span><span class="fu">qvcalc</span><span class="op">(</span><span class="va">object</span>, factorname <span class="op">=</span> <span class="cn">NULL</span>, coef.indices <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for survreg</span></span>
<span><span class="fu">qvcalc</span><span class="op">(</span><span class="va">object</span>, factorname <span class="op">=</span> <span class="cn">NULL</span>, coef.indices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for itempar</span></span>
<span><span class="fu">qvcalc</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>For <code>qvcalc.default</code>, this is the covariance (sub)matrix
  for the parameters of interest (including any that may have been
  constrained to zero).  For the generic <code>qvcalc</code>, the
  <code>object</code> can be any object for which the relevant S3 method has
  been defined.  These currently include many types of regression model
  (via <code>qvcalc.lm</code>), including objects of classes
  <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></code> and <code><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survreg</a></code>; 
  and also objects of class
  <code>itempar</code>.</p></dd>

<dt>factorname</dt>
<dd><p>Either <code>NULL</code>, or a character vector of length 1</p></dd>

<dt>coef.indices</dt>
<dd><p>Either <code>NULL</code>, or a numeric vector of length at
  least 3</p></dd>
  
<dt>labels</dt>
<dd><p>An optional vector of row names for the <code>qvframe</code>
  component of the result (redundant if <code>object</code> is a model)</p></dd>

<dt>dispersion</dt>
<dd><p>an optional scalar multiplier for the covariance
  matrix, to cope with overdispersion for example</p></dd>

<dt>estimates</dt>
<dd><p>an optional vector of estimated coefficients (redundant
  if <code>object</code> is a model, for example)</p></dd>

<dt>modelcall</dt>
<dd><p>optional, the call expression for the model of interest
  (redundant if <code>object</code> is a model with its own <code>call</code> component)</p></dd>

<dt>...</dt>
<dd><p>other arguments to pass to <code>qv.default</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p>The <code>qvcalc.default</code> method is the computational backend for
  all other, class-specific methods.</p>
<p>In <code>qvcalc.default</code>, none of the arguments other than
  <code>object</code> is used in computing the result.  The remaining
  arguments are simply passed through to the result object as components
  to help with record-keeping etc.</p>
<p>In <code>qvcalc.lm</code>, at least one of <code>factorname</code> or
  <code>coef.indices</code> must be non-<code>NULL</code>.  The value of
  <code>coef.indices</code>, if non-<code>NULL</code>, determines which rows
  and columns of the model's variance-covariance matrix to use.  If
  <code>coef.indices</code> contains a zero, then an extra row and column are
  included at the indicated position, to represent the zero variances and
  covariances associated with a reference level.  If <code>coef.indices</code>
  is <code>NULL</code>, then <code>factorname</code> should be the name of a factor
  effect in the model, and is used in order to extract the necessary
  variance-covariance estimates.</p>
<p>For <code>qvcalc.itempar</code>, the <code>"itempar"</code> object must have the
  full variance-covariance matrix in its <code>"vcov"</code> attribute, and
  must have its <code>"alias"</code> attribute be <code>TRUE</code>.  These
  attributes result from use of the default arguments
  <code>vcov = TRUE, alias = TRUE</code>
  when the <code>itempar</code> function is called.</p>  
<p>Ordinarily the quasi variances are positive and so their square roots
  (the quasi standard errors) exist and can be used in plots, etc.</p>
<p>Occasionally one (and only one) of the quasi variances is negative, and
  so the corresponding quasi standard error does not exist (it appears as
  <code>NaN</code>).  This is fairly rare in applications, and
  when it occurs it is because the factor of interest is strongly
  correlated with one or more other predictors in the model.  It is not
  an indication that quasi variances are inaccurate.  An example is shown
  below using
  data from the <code>car</code> package: the quasi variance
  approximation
  is exact (since <code>type</code> has
  only 3 levels), and there is a negative quasi variance.  The quasi
  variances remain perfectly valid (they can be used to obtain
  inference on any contrast), but it makes no sense to plot
  `comparison intervals' in the usual way since one of the quasi standard
  errors is not a real number.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of class <code>qv</code>, with components</p>
<dl><dt>covmat</dt>
<dd><p>the full variance-covariance matrix for the estimated 
  coefficients corresponding to the factor of interest</p></dd>

<dt>qvframe</dt>
<dd><p>a data frame with variables
  <code>estimate</code>, <code>SE</code>, <code>quasiSE</code> and <code>quasiVar</code>,
  the last two being a quasi standard error and quasi-variance
  for each level of the factor of interest</p></dd>

<dt>relerrs</dt>
<dd><p>relative errors for approximating the standard errors of all 
  simple contrasts</p></dd>

<dt>factorname</dt>
<dd><p>the factor name if given</p></dd>

<dt>coef.indices</dt>
<dd><p>the coefficient indices if given</p></dd>

<dt>modelcall</dt>
<dd><p>if <code>object</code> is a model, <code>object$call</code>;
  otherwise <code>NULL</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Easton, D. F, Peto, J. and Babiker, A. G. A. G. (1991)  
Floating absolute risk: an alternative to relative risk in survival 
and case-control analysis avoiding an arbitrary reference group.  
<em>Statistics in Medicine</em> <b>10</b>, 1025--1035.</p>
<p>Firth, D. (2000)  Quasi-variances in Xlisp-Stat and on the web.  
  <em>Journal of Statistical Software</em> <b>5.4</b>, 1--13.  
  <a href="https://doi.org/10.18637/jss.v005.i04" class="external-link">doi:10.18637/jss.v005.i04</a></p>
<p>Firth, D. (2003) Overcoming the reference category problem in the 
presentation of statistical models. <em>Sociological Methodology</em> 
<b>33</b>, 1--18. <a href="https://doi.org/10.1111/j.0081-1750.2003.t01-1-00125.x" class="external-link">doi:10.1111/j.0081-1750.2003.t01-1-00125.x</a></p>
<p>Firth, D. and de Mezezes, R. X. (2004)  Quasi-variances.  
  <em>Biometrika</em> <b>91</b>, 65--80. <a href="https://doi.org/10.1093/biomet/91.1.65" class="external-link">doi:10.1093/biomet/91.1.65</a></p>
<p>McCullagh, P. and Nelder, J. A. (1989) <em>Generalized Linear Models</em>.
  London: Chapman and Hall.</p>
<p>Menezes, R. X. de (1999)  More useful standard errors for group and factor
  effects in generalized linear models.  <em>D.Phil. Thesis</em>,
  Department of Statistics, University of Oxford.</p>
<p>Ridout, M.S. (1989). Summarizing the results of fitting generalized
  linear models to data from designed experiments. In: <em>Statistical
  Modelling: Proceedings of GLIM89 and the 4th International
  Workshop on Statistical Modelling held in Trento, Italy, July 17--21,
  1989</em> (A. Decarli et al., eds.), pp 262--269. New York: Springer.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Firth, <a href="mailto:d.firth@warwick.ac.uk">d.firth@warwick.ac.uk</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="worstErrors.html">worstErrors</a></code>, <code><a href="plot.qv.html">plot.qv</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##  Overdispersed Poisson loglinear model for ship damage data</span></span></span>
<span class="r-in"><span><span class="co">##  from McCullagh and Nelder (1989), Sec 6.3.2 </span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ships</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">ships</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ships</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">ships</span><span class="op">$</span><span class="va">period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ships</span><span class="op">$</span><span class="va">period</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">shipmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">incidents</span> <span class="op">~</span> <span class="va">type</span> <span class="op">+</span> <span class="va">year</span> <span class="op">+</span> <span class="va">period</span>,</span></span>
<span class="r-in"><span>                     family <span class="op">=</span> <span class="va">quasipoisson</span>, </span></span>
<span class="r-in"><span>                     data <span class="op">=</span> <span class="va">ships</span>,</span></span>
<span class="r-in"><span>                     subset <span class="op">=</span> <span class="op">(</span><span class="va">service</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">service</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">shiptype.qv</span> <span class="op">&lt;-</span> <span class="fu">qvcalc</span><span class="op">(</span><span class="va">shipmodel</span>, <span class="st">"type"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## We can plot "comparison intervals" as follows:</span></span></span>
<span class="r-in"><span>    <span class="co">##   plot(shiptype.qv, xlab = "ship type")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## An equivalent result by using the coef.indices argument instead:</span></span></span>
<span class="r-in"><span>    <span class="co">##   shiptype.qv2 &lt;- qvcalc(shipmodel, coef.indices = c(0, 2:5))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">shiptype.qv</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model call:  glm(formula = incidents ~ type + year + period, family = quasipoisson,      data = ships, subset = (service &gt; 0), offset = log(service)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor name:  type </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       estimate     SE quasiSE quasiVar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     A  0.00000 0.0000  0.2010  0.04039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     B -0.54334 0.2309  0.1127  0.01270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     C -0.68740 0.4279  0.3753  0.14081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     D -0.07596 0.3779  0.3239  0.10491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     E  0.32558 0.3067  0.2322  0.05390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Worst relative errors in SEs of simple contrasts (%):  -0.7 0.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Worst relative errors over *all* contrasts (%):  -2.1 1.6 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example of a "coxph" model</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"veteran"</span>, package <span class="op">=</span> <span class="st">"survival"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">cancer_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">celltype</span>, data <span class="op">=</span> <span class="va">veteran</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">celltype_qv</span> <span class="op">&lt;-</span> <span class="fu">qvcalc</span><span class="op">(</span><span class="va">cancer_model</span>, <span class="st">"celltype"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">celltype_qv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: survival</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>data set ‘veteran’ not found</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model call:  coxph(formula = Surv(time, status) ~ celltype, data = veteran) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor name:  celltype </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                estimate        SE   quasiSE   quasiVar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     squamous  0.0000000 0.0000000 0.2023772 0.04095651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     smallcell 1.0012532 0.2535074 0.1501828 0.02255487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     adeno     1.1477130 0.2928805 0.2049427 0.04200152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     large     0.2301455 0.2772930 0.1991861 0.03967510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Worst relative errors in SEs of simple contrasts (%):  -1.7 2.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Worst relative errors over *all* contrasts (%):  -4.1 3.1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example of a "survreg" model</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"veteran"</span>, package <span class="op">=</span> <span class="st">"survival"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">cancer_model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survreg.html" class="external-link">survreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">celltype</span>, data <span class="op">=</span> <span class="va">veteran</span>,</span></span>
<span class="r-in"><span>                             dist <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">celltype_qv2</span> <span class="op">&lt;-</span> <span class="fu">qvcalc</span><span class="op">(</span><span class="va">cancer_model2</span>, <span class="st">"celltype"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">celltype_qv2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>data set ‘veteran’ not found</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model call:  survreg(formula = Surv(time, status) ~ celltype, data = veteran,      dist = "weibull") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor name:  celltype </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 estimate        SE   quasiSE   quasiVar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     squamous   0.0000000 0.0000000 0.1852658 0.03432341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     smallcell -1.0831923 0.2405345 0.1537001 0.02362371</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     adeno     -1.2162022 0.2743860 0.2022180 0.04089213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     large     -0.2627843 0.2745644 0.2024398 0.04098189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Worst relative errors in SEs of simple contrasts (%):  -0.1 0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Worst relative errors over *all* contrasts (%):  -0.2 0.1 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Based on an example from ?itempar</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">psychotools</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"VerbalAggression"</span>, package <span class="op">=</span> <span class="st">"psychotools"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">raschmod</span> <span class="op">&lt;-</span> <span class="fu">raschmodel</span><span class="op">(</span><span class="va">VerbalAggression</span><span class="op">$</span><span class="va">resp2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">ip1</span> <span class="op">&lt;-</span> <span class="fu">itempar</span><span class="op">(</span><span class="va">raschmod</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">qv1</span> <span class="op">&lt;-</span> <span class="fu">qvcalc</span><span class="op">(</span><span class="va">ip1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">qv1</span><span class="op">)</span> <span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: psychotools</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>there is no package called ‘psychotools’</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##  Example of a negative quasi variance</span></span></span>
<span class="r-in"><span><span class="co">##  Requires the "car" package</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Prestige</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">Prestige</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mymodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">prestige</span> <span class="op">~</span> <span class="va">type</span> <span class="op">+</span> <span class="va">education</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://davidfirth.github.io/qvcalc" class="external-link">qvcalc</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">type.qvs</span> <span class="op">&lt;-</span> <span class="fu">qvcalc</span><span class="op">(</span><span class="va">mymodel</span>, <span class="st">"type"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">##  Warning message: </span></span></span>
<span class="r-in"><span>    <span class="co">##  In sqrt(qv) : NaNs produced</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">type.qvs</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">##  Model call:  lm(formula = prestige ~ type + education) </span></span></span>
<span class="r-in"><span>    <span class="co">##  Factor name:  type </span></span></span>
<span class="r-in"><span>    <span class="co">##          estimate       SE  quasiSE  quasiVar</span></span></span>
<span class="r-in"><span>    <span class="co">##    bc    0.000000 0.000000 2.874361  8.261952</span></span></span>
<span class="r-in"><span>    <span class="co">##    prof  6.142444 4.258961 3.142737  9.876793</span></span></span>
<span class="r-in"><span>    <span class="co">##    wc   -5.458495 2.690667      NaN -1.022262</span></span></span>
<span class="r-in"><span>    <span class="co">##  Worst relative errors in SEs of simple contrasts (%):  0 0 </span></span></span>
<span class="r-in"><span>    <span class="co">##  Worst relative errors over *all* contrasts (%):  0 0</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">type.qvs</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">##  Error in plot.qv(type.qvs) :  No comparison intervals available,</span></span></span>
<span class="r-in"><span>    <span class="co">##  since one of the quasi variances is negative.  See ?qvcalc for more.</span></span></span>
<span class="r-in"><span><span class="op">}</span> </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by David Firth.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

