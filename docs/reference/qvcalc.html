<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Quasi Variances for Model Coefficients — qvcalc • qvcalc</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Quasi Variances for Model Coefficients — qvcalc" />

<meta property="og:description" content="Computes a set of quasi variances (and corresponding
  quasi standard errors) for estimated model coefficients
  relating to the levels of a categorical (i.e., factor)
  explanatory variable.  For details of the method see
  Firth (2000), Firth (2003) or Firth and de Menezes (2004).
  Quasi variances generalize and improve the accuracy of
  &amp;#8220;floating absolute risk&amp;#8221; (Easton et al., 1991).
  This device for economical model summary was
  first suggested by Ridout (1989)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">qvcalc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quasi Variances for Model Coefficients</h1>
    
    <div class="hidden name"><code>qvcalc.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Computes a set of quasi variances (and corresponding
  quasi standard errors) for estimated model coefficients
  relating to the levels of a categorical (i.e., factor)
  explanatory variable.  For details of the method see
  Firth (2000), Firth (2003) or Firth and de Menezes (2004).
  Quasi variances generalize and improve the accuracy of
  &#8220;floating absolute risk&#8221; (Easton et al., 1991).
  This device for economical model summary was
  first suggested by Ridout (1989).</p>
    
    </div>

    <pre class="usage"><span class='fu'>qvcalc</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>qvcalc</span>(<span class='no'>object</span>, <span class='kw'>factorname</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,  <span class='kw'>coef.indices</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
      <span class='kw'>labels</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>dispersion</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
      <span class='kw'>estimates</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>modelcall</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for lm</span>
<span class='fu'>qvcalc</span>(<span class='no'>object</span>, <span class='kw'>factorname</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>coef.indices</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
       <span class='kw'>dispersion</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for itempar</span>
<span class='fu'>qvcalc</span>(<span class='no'>object</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>For <code>qvcalc.default</code>, this is the covariance (sub)matrix
  for the parameters of interest (including any that may have been
  constrained to zero).  For the generic <code>qvcalc</code>, the
  <code>object</code> can be any object for which the relevant S3 method has
  been defined.  These currently include many types of regression model
  (via <code>qvcalc.lm</code>) and objects of class
  <code>itempar</code>.</p></td>
    </tr>
    <tr>
      <th>factorname</th>
      <td><p>Either <code>NULL</code>, or a character vector of length 1</p></td>
    </tr>
    <tr>
      <th>coef.indices</th>
      <td><p>Either <code>NULL</code>, or a numeric vector of length at
  least 3</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>An optional vector of row names for the <code>qvframe</code>
  component of the result (redundant if <code>object</code> is a model)</p></td>
    </tr>
    <tr>
      <th>dispersion</th>
      <td><p>an optional scalar multiplier for the covariance
  matrix, to cope with overdispersion for example</p></td>
    </tr>
    <tr>
      <th>estimates</th>
      <td><p>an optional vector of estimated coefficients (redundant
  if <code>object</code> is a model, for example)</p></td>
    </tr>
    <tr>
      <th>modelcall</th>
      <td><p>optional, the call expression for the model of interest
  (redundant if <code>object</code> is a model with its own <code>call</code> component)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments to pass to <code>qv.default</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
    <p>The <code>qvcalc.default</code> method is the computational backend for
  all other, class-specific methods.</p>
<p>In <code>qvcalc.default</code>, none of the arguments other than
  <code>object</code> is used in computing the result.  The remaining
  arguments are simply passed through to the result object as components
  to help with record-keeping etc.</p>
<p>In <code>qvcalc.lm</code>, at least one of <code>factorname</code> or
  <code>coef.indices</code> must be non-<code>NULL</code>.  The value of
  <code>coef.indices</code>, if non-<code>NULL</code>, determines which rows
  and columns of the model's variance-covariance matrix to use.  If
  <code>coef.indices</code> contains a zero, then an extra row and column are
  included at the indicated position, to represent the zero variances and
  covariances associated with a reference level.  If <code>coef.indices</code>
  is <code>NULL</code>, then <code>factorname</code> should be the name of a factor
  effect in the model, and is used in order to extract the necessary
  variance-covariance estimates.</p>
<p>For <code>qvcalc.itempar</code>, the <code>"itempar"</code> object must have the
  full variance-covariance matrix in its <code>"vcov"</code> attribute, and
  must have its <code>"alias"</code> attribute be <code>TRUE</code>.  These
  attributes result from use of the default arguments
  <code>vcov = TRUE, alias = TRUE</code>
  when the <code>itempar</code> function is called.</p>  
<p>Ordinarily the quasi variances are positive and so their square roots
  (the quasi standard errors) exist and can be used in plots, etc.</p>
<p>Occasionally one (and only one) of the quasi variances is negative, and
  so the corresponding quasi standard error does not exist (it appears as
  <code>NaN</code>).  This is fairly rare in applications, and
  when it occurs it is because the factor of interest is strongly
  correlated with one or more other predictors in the model.  It is not
  an indication that quasi variances are inaccurate.  An example is shown
  below using
  data from the <code>car</code> package: the quasi variance
  approximation
  is exact (since <code>type</code> has
  only 3 levels), and there is a negative quasi variance.  The quasi
  variances remain perfectly valid (they can be used to obtain
  inference on any contrast), but it makes no sense to plot
  `comparison intervals' in the usual way since one of the quasi standard
  errors is not a real number.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code>qv</code>, with components</p>
<dt>covmat</dt><dd><p>the full variance-covariance matrix for the estimated 
  coefficients corresponding to the factor of interest</p></dd>
<dt>qvframe</dt><dd><p>a data frame with variables
  <code>estimate</code>, <code>SE</code>, <code>quasiSE</code> and <code>quasiVar</code>,
  the last two being a quasi standard error and quasi-variance
  for each level of the factor of interest</p></dd>
<dt>relerrs</dt><dd><p>relative errors for approximating the standard errors of all 
  simple contrasts</p></dd>
<dt>factorname</dt><dd><p>the factor name if given</p></dd>
<dt>coef.indices</dt><dd><p>the coefficient indices if given</p></dd>
<dt>modelcall</dt><dd><p>if <code>object</code> is a model, <code>object$call</code>;
  otherwise <code>NULL</code></p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Easton, D. F, Peto, J. and Babiker, A. G. A. G. (1991)  
Floating absolute risk: an alternative to relative risk in survival 
and case-control analysis avoiding an arbitrary reference group.  
<em>Statistics in Medicine</em> <b>10</b>, 1025--1035.</p>
<p>Firth, D. (2000)  Quasi-variances in Xlisp-Stat and on the web.  
  <em>Journal of Statistical Software</em> <b>5.4</b>, 1--13.  
  At <a href='http://www.jstatsoft.org'>http://www.jstatsoft.org</a></p>
<p>Firth, D. (2003) Overcoming the reference category problem in the 
presentation of statistical models. <em>Sociological Methodology</em> 
<b>33</b>, 1--18.</p>
<p>Firth, D. and de Mezezes, R. X. (2004)  Quasi-variances.  
  <em>Biometrika</em> <b>91</b>, 65--80.</p>
<p>McCullagh, P. and Nelder, J. A. (1989) <em>Generalized Linear Models</em>.
  London: Chapman and Hall.</p>
<p>Menezes, R. X. de (1999)  More useful standard errors for group and factor
  effects in generalized linear models.  <em>D.Phil. Thesis</em>,
  Department of Statistics, University of Oxford.</p>
<p>Ridout, M.S. (1989). Summarizing the results of fitting generalized
  linear models to data from designed experiments. In: <em>Statistical
  Modelling: Proceedings of GLIM89 and the 4th International
  Workshop on Statistical Modelling held in Trento, Italy, July 17--21,
  1989</em> (A. Decarli et al., eds.), pp 262--269. New York: Springer.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='worstErrors.html'>worstErrors</a></code>, <code><a href='plot.qv.html'>plot.qv</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##  Overdispersed Poisson loglinear model for ship damage data</span>
<span class='co'>##  from McCullagh and Nelder (1989), Sec 6.3.2 </span>
<span class='kw'>if</span> (<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>MASS</span>)) {
    <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>ships</span>)
    <span class='no'>ships</span>$<span class='no'>year</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>as.factor</a></span>(<span class='no'>ships</span>$<span class='no'>year</span>)
    <span class='no'>ships</span>$<span class='no'>period</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>as.factor</a></span>(<span class='no'>ships</span>$<span class='no'>period</span>)
    <span class='no'>shipmodel</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></span>(<span class='kw'>formula</span> <span class='kw'>=</span> <span class='no'>incidents</span> ~ <span class='no'>type</span> + <span class='no'>year</span> + <span class='no'>period</span>,
                     <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>quasipoisson</span>,
                     <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ships</span>,
                     <span class='kw'>subset</span> <span class='kw'>=</span> (<span class='no'>service</span> <span class='kw'>&gt;</span> <span class='fl'>0</span>),
                     <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>service</span>))
    <span class='no'>shiptype.qvs</span> <span class='kw'>&lt;-</span> <span class='fu'>qvcalc</span>(<span class='no'>shipmodel</span>, <span class='st'>"type"</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>shiptype.qvs</span>, <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>4</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>shiptype.qvs</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"ship type"</span>)
<span class='co'>## An equivalent result by using the coef.indices argument instead:</span>
    <span class='no'>shiptype.qv2</span> <span class='kw'>&lt;-</span> <span class='fu'>qvcalc</span>(<span class='no'>shipmodel</span>, <span class='kw'>coef.indices</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>2</span>:<span class='fl'>5</span>))
}</div><div class='output co'>#&gt; Model call:  glm(formula = incidents ~ type + year + period, family = quasipoisson,      data = ships, subset = (service &gt; 0), offset = log(service)) 
#&gt; Factor name:  type 
#&gt;       estimate     SE quasiSE quasiVar
#&gt;     A  0.00000 0.0000  0.2010  0.04039
#&gt;     B -0.54334 0.2309  0.1127  0.01270
#&gt;     C -0.68740 0.4279  0.3753  0.14081
#&gt;     D -0.07596 0.3779  0.3239  0.10491
#&gt;     E  0.32558 0.3067  0.2322  0.05390
#&gt; Worst relative errors in SEs of simple contrasts (%):  -0.7 0.9 
#&gt; Worst relative errors over *all* contrasts (%):  -2.1 1.6 </div><div class='img'><img src='qvcalc-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Based on an example from ?itempar</span>
<span class='kw'>if</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>psychotools</span>)) {
    <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"VerbalAggression"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"psychotools"</span>)
    <span class='no'>raschmod</span> <span class='kw'>&lt;-</span> <span class='fu'>raschmodel</span>(<span class='no'>VerbalAggression</span>$<span class='no'>resp2</span>)
    <span class='no'>ip1</span> <span class='kw'>&lt;-</span> <span class='fu'>itempar</span>(<span class='no'>raschmod</span>)
    <span class='no'>qv1</span> <span class='kw'>&lt;-</span> <span class='fu'>qvcalc</span>(<span class='no'>ip1</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>qv1</span>) }</div><div class='output co'>#&gt; <span class='message'>Loading required package: psychotools</span></div><div class='output co'>#&gt; <span class='warning'>Warning: there is no package called ‘psychotools’</span></div><div class='input'>
##  Example of a negative quasi variance
##  Requires the "car" package
</div><span class='co'># NOT RUN {</span>
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>car</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>Prestige</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/attach'>attach</a></span>(<span class='no'>Prestige</span>)
    <span class='no'>mymodel</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/lm'>lm</a></span>(<span class='no'>prestige</span> ~ <span class='no'>type</span> + <span class='no'>education</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>qvcalc</span>)
    <span class='no'>type.qvs</span> <span class='kw'>&lt;-</span> <span class='fu'>qvcalc</span>(<span class='no'>mymodel</span>, <span class='st'>"type"</span>)
    <span class='co'>##  Warning message: </span>
    <span class='co'>##  In sqrt(qv) : NaNs produced</span>
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>type.qvs</span>)
    <span class='co'>##  Model call:  lm(formula = prestige ~ type + education) </span>
    <span class='co'>##  Factor name:  type </span>
    <span class='co'>##          estimate       SE  quasiSE  quasiVar</span>
    <span class='co'>##    bc    0.000000 0.000000 2.874361  8.261952</span>
    <span class='co'>##    prof  6.142444 4.258961 3.142737  9.876793</span>
    <span class='co'>##    wc   -5.458495 2.690667      NaN -1.022262</span>
    <span class='co'>##  Worst relative errors in SEs of simple contrasts (%):  0 0 </span>
    <span class='co'>##  Worst relative errors over *all* contrasts (%):  0 0</span>
    <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>type.qvs</span>)
    <span class='co'>##  Error in plot.qv(type.qvs) :  No comparison intervals available,</span>
    <span class='co'>##  since one of the quasi variances is negative.  See ?qvcalc for more.</span>
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>David Firth, <a href='mailto:d.firth@warwick.ac.uk'>d.firth@warwick.ac.uk</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by David Firth.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

